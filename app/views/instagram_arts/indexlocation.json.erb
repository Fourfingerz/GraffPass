<% if(params.has_key?(:page)) %>
<%   page_count = params[:page].to_i %>
<%   page_range_low = 1 + (10 * page_count) %>
<% else %>
<%   page_count = 1 %>
<%   page_range_low = 1 %>
<% end %>
{
  "search_term": "<%= params[:search] %>",
  "page_number": <%= page_count %>,
  "page_total": <%= @instagram_arts.total_pages %>,
  "result": {
    "count": <%= @result_count %>,
    "low": <%= page_range_low %>,
    "high": <%= page_range_low + 25 %>
  },
  "data": [
    <% len = @instagram_arts.length %>
    <% @instagram_arts.each_with_index do |instagram_art, index| %>
      <% art_coordinates = [instagram_art.latitude, instagram_art.longitude] %>
      <% distance_apart = Geocoder::Calculations.distance_between(art_coordinates, @result_coordinates) %>
      {
        "type": "Feature",
        "geometry": {
          "type": "Point",
          "coordinates": [<%= instagram_art.latitude %>, <%= instagram_art.longitude %>]
        },
        "properties": {
          "title": "<%= instagram_art.image_url %>",
          "description": "<%= instagram_art.tags %>",
          "count": <%= index %>,
          "id": <%= instagram_art.id %>
        }
      }<% if index+1 != len %><%= ',' %><% end %>
    <% end %>
  ]
}
